# --- Setup ---

self := "setup"
import "../prelude/task/justfile"
_default: help

# --- Tasks ---

# Install desired brew packages.
brew:
  #!/usr/bin/env bash
  set -euo pipefail

  # Bitwarden password manager.
  brew install --cask bitwarden

  # Arc browser.
  brew install --cask arc

  # Warp terminal.
  brew install --cask warp

  # Dock utility to manage macOS dock items.
  # - https://formulae.brew.sh/formula/dockutil
  # - https://github.com/kcrawford/dockutil
  brew install dockutil

# Manual steps needed for arc.
arc:
  #!/usr/bin/env bash
  set -euo pipefail

  # Action items.
  # - [ ] Login.
  # - [ ] Settings -> Kyle -> Sync sidebar.
  # - [ ] Settings -> Profiles -> Make: Personal, Stoke, Ragkit.
  # - [ ] Settings -> Profiles -> Set as Default
  # - [ ] Settings -> Profiles -> Archive Tabs after 30 days
  # - [ ] Settings -> Profiles -> Downloads -> Ask Every Time
  # - [ ] Settings -> Arc -> Set as Default Browser
  # - [ ] On Each Profile -> Passwords -> Settings -> Disable Offer to Save Passwords

# Configures the mac dock.
mac-dock:
  #!/usr/bin/env bash
  set -euo pipefail

  # TODO: Check that dockutil is installed. Say to use brew install if not.

  # Keep: Finder, System Settings, Downloads, Trash.
  dockutil --remove "Launchpad" --no-restart
  dockutil --remove "Messages" --no-restart
  dockutil --remove "Safari" --no-restart
  dockutil --remove "Mail" --no-restart
  dockutil --remove "Maps" --no-restart
  dockutil --remove "Photos" --no-restart
  dockutil --remove "FaceTime" --no-restart
  dockutil --remove "Calendar" --no-restart
  dockutil --remove "Contacts" --no-restart
  dockutil --remove "Reminders" --no-restart
  dockutil --remove "Notes" --no-restart
  dockutil --remove "Freeform" --no-restart
  dockutil --remove "TV" --no-restart
  dockutil --remove "Music" --no-restart
  dockutil --remove "News" --no-restart
  dockutil --remove "Keynote" --no-restart
  dockutil --remove "Numbers" --no-restart
  dockutil --remove "Pages" --no-restart
  dockutil --remove "App Store" --no-restart
  # Finally; do a restart.
  dockutil --remove spacer-tiles --restart

mac-defaults:
  #!/usr/bin/env bash
  set -euo pipefail

  # Check if we are on macOS.
